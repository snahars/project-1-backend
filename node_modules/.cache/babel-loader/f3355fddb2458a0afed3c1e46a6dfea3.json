{"ast":null,"code":"import { showError } from \"../app/pages/Alert\";\nimport * as auth from \"../app/modules/Auth/_redux/authRedux\";\nexport default function setupAxios(axios, store) {\n  // const splashScreen = document.getElementById(\"splash-screen\");\n  axios.interceptors.request.use(function (config) {\n    // splashScreen.classList.remove(\"hidden\");\n    store.dispatch({\n      type: auth.actionTypes.SetLoader,\n      payload: {\n        loaderOpen: true\n      }\n    });\n\n    var _store$getState = store.getState(),\n        authToken = _store$getState.auth.authToken;\n\n    if (authToken) {\n      config.headers.Authorization = \"Bearer \".concat(authToken);\n    }\n\n    return config;\n  }, function (err) {\n    // splashScreen.classList.remove(\"hidden\");\n    store.dispatch({\n      type: auth.actionTypes.SetLoader,\n      payload: {\n        loaderOpen: true\n      }\n    });\n    Promise.reject(err);\n  });\n  axios.interceptors.response.use(function (response) {\n    // splashScreen.classList.add(\"hidden\");\n    store.dispatch({\n      type: auth.actionTypes.SetLoader,\n      payload: {\n        loaderOpen: false\n      }\n    });\n\n    if (response.status === 401) {\n      showError('You are not authorized');\n    }\n\n    return response;\n  }, function (error) {\n    // splashScreen.classList.add(\"hidden\");\n    store.dispatch({\n      type: auth.actionTypes.SetLoader,\n      payload: {\n        loaderOpen: false\n      }\n    });\n\n    if (error.url) {\n      if (error.url.includes('/login')) {\n        return;\n      }\n    }\n\n    if (error.message.includes('401') && error.config.headers.Authorization != undefined) {\n      showError('Session expired! Please login.');\n    } else if (error.name === 'Error' && error.config.headers.Authorization != undefined) {\n      showError(error.message);\n    } else if (error.message == undefined) {\n      showError('Unknown Error!');\n    }\n\n    if (error.response && error.response.data) {\n      return Promise.reject(error.response.data);\n    }\n\n    return Promise.reject(error.message);\n  });\n}","map":{"version":3,"names":["showError","auth","setupAxios","axios","store","interceptors","request","use","config","dispatch","type","actionTypes","SetLoader","payload","loaderOpen","getState","authToken","headers","Authorization","err","Promise","reject","response","status","error","url","includes","message","undefined","name","data"],"sources":["/home/sunipa/projects/sncworkspace/ntl-snc_frontend/src/redux/setupAxios.js"],"sourcesContent":["import { showError } from \"../app/pages/Alert\";\r\nimport * as auth from \"../app/modules/Auth/_redux/authRedux\";\r\n\r\nexport default function setupAxios(axios, store) {\r\n  // const splashScreen = document.getElementById(\"splash-screen\");\r\n\r\n  axios.interceptors.request.use(\r\n    config => {\r\n      // splashScreen.classList.remove(\"hidden\");\r\n      store.dispatch({type: auth.actionTypes.SetLoader, payload: {loaderOpen: true}})\r\n      const {\r\n        auth: { authToken }\r\n      } = store.getState();\r\n\r\n      if (authToken) {\r\n        config.headers.Authorization = `Bearer ${authToken}`;\r\n      }\r\n      return config;\r\n    },\r\n    err => {\r\n      // splashScreen.classList.remove(\"hidden\");\r\n      store.dispatch({type: auth.actionTypes.SetLoader, payload: {loaderOpen: true}})\r\n      Promise.reject(err)\r\n    }\r\n  );\r\n\r\n  axios.interceptors.response.use((response) => {\r\n    // splashScreen.classList.add(\"hidden\");\r\n    store.dispatch({type: auth.actionTypes.SetLoader, payload: {loaderOpen: false}})\r\n    if(response.status === 401) {\r\n        showError('You are not authorized');\r\n    }\r\n    return response;\r\n  }, \r\n  (error) => {\r\n    // splashScreen.classList.add(\"hidden\");\r\n    store.dispatch({type: auth.actionTypes.SetLoader, payload: {loaderOpen: false}})\r\n\r\n    if(error.url){\r\n      if(error.url.includes('/login')){\r\n        return;\r\n      }      \r\n    }  \r\n\r\n    if(error.message.includes('401') && error.config.headers.Authorization != undefined){\r\n      showError('Session expired! Please login.');\r\n    }else if(error.name === 'Error' && error.config.headers.Authorization != undefined){\r\n      showError(error.message);\r\n    }else if(error.message == undefined){\r\n      showError('Unknown Error!');\r\n    }\r\n    \r\n    if (error.response && error.response.data) {\r\n      return Promise.reject(error.response.data);\r\n    }\r\n    return Promise.reject(error.message);\r\n  });\r\n}\r\n"],"mappings":"AAAA,SAASA,SAAT,QAA0B,oBAA1B;AACA,OAAO,KAAKC,IAAZ,MAAsB,sCAAtB;AAEA,eAAe,SAASC,UAAT,CAAoBC,KAApB,EAA2BC,KAA3B,EAAkC;EAC/C;EAEAD,KAAK,CAACE,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CACE,UAAAC,MAAM,EAAI;IACR;IACAJ,KAAK,CAACK,QAAN,CAAe;MAACC,IAAI,EAAET,IAAI,CAACU,WAAL,CAAiBC,SAAxB;MAAmCC,OAAO,EAAE;QAACC,UAAU,EAAE;MAAb;IAA5C,CAAf;;IACA,sBAEIV,KAAK,CAACW,QAAN,EAFJ;IAAA,IACUC,SADV,mBACEf,IADF,CACUe,SADV;;IAIA,IAAIA,SAAJ,EAAe;MACbR,MAAM,CAACS,OAAP,CAAeC,aAAf,oBAAyCF,SAAzC;IACD;;IACD,OAAOR,MAAP;EACD,CAZH,EAaE,UAAAW,GAAG,EAAI;IACL;IACAf,KAAK,CAACK,QAAN,CAAe;MAACC,IAAI,EAAET,IAAI,CAACU,WAAL,CAAiBC,SAAxB;MAAmCC,OAAO,EAAE;QAACC,UAAU,EAAE;MAAb;IAA5C,CAAf;IACAM,OAAO,CAACC,MAAR,CAAeF,GAAf;EACD,CAjBH;EAoBAhB,KAAK,CAACE,YAAN,CAAmBiB,QAAnB,CAA4Bf,GAA5B,CAAgC,UAACe,QAAD,EAAc;IAC5C;IACAlB,KAAK,CAACK,QAAN,CAAe;MAACC,IAAI,EAAET,IAAI,CAACU,WAAL,CAAiBC,SAAxB;MAAmCC,OAAO,EAAE;QAACC,UAAU,EAAE;MAAb;IAA5C,CAAf;;IACA,IAAGQ,QAAQ,CAACC,MAAT,KAAoB,GAAvB,EAA4B;MACxBvB,SAAS,CAAC,wBAAD,CAAT;IACH;;IACD,OAAOsB,QAAP;EACD,CAPD,EAQA,UAACE,KAAD,EAAW;IACT;IACApB,KAAK,CAACK,QAAN,CAAe;MAACC,IAAI,EAAET,IAAI,CAACU,WAAL,CAAiBC,SAAxB;MAAmCC,OAAO,EAAE;QAACC,UAAU,EAAE;MAAb;IAA5C,CAAf;;IAEA,IAAGU,KAAK,CAACC,GAAT,EAAa;MACX,IAAGD,KAAK,CAACC,GAAN,CAAUC,QAAV,CAAmB,QAAnB,CAAH,EAAgC;QAC9B;MACD;IACF;;IAED,IAAGF,KAAK,CAACG,OAAN,CAAcD,QAAd,CAAuB,KAAvB,KAAiCF,KAAK,CAAChB,MAAN,CAAaS,OAAb,CAAqBC,aAArB,IAAsCU,SAA1E,EAAoF;MAClF5B,SAAS,CAAC,gCAAD,CAAT;IACD,CAFD,MAEM,IAAGwB,KAAK,CAACK,IAAN,KAAe,OAAf,IAA0BL,KAAK,CAAChB,MAAN,CAAaS,OAAb,CAAqBC,aAArB,IAAsCU,SAAnE,EAA6E;MACjF5B,SAAS,CAACwB,KAAK,CAACG,OAAP,CAAT;IACD,CAFK,MAEA,IAAGH,KAAK,CAACG,OAAN,IAAiBC,SAApB,EAA8B;MAClC5B,SAAS,CAAC,gBAAD,CAAT;IACD;;IAED,IAAIwB,KAAK,CAACF,QAAN,IAAkBE,KAAK,CAACF,QAAN,CAAeQ,IAArC,EAA2C;MACzC,OAAOV,OAAO,CAACC,MAAR,CAAeG,KAAK,CAACF,QAAN,CAAeQ,IAA9B,CAAP;IACD;;IACD,OAAOV,OAAO,CAACC,MAAR,CAAeG,KAAK,CAACG,OAArB,CAAP;EACD,CA9BD;AA+BD"},"metadata":{},"sourceType":"module"}